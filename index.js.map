{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport { linkEl } from '../main';\nconst URL_PIXABAY = 'https://pixabay.com/api/';\nconst API_KEY = '46219346-243694830f7cca451bf7f7da0';\nexport const PER_PAGE = 15;\n\nexport async function fetchImages(query, page = 1) {\n    if (query === '') {\n        iziToast.error({\n            position: 'topRight',\n            message: 'Введіть будь-ласка значення для пошуку',\n        });\n        return;\n    }\n\n    // використовуємо обєкт параметрів пошуку\n\n    const searchParams = new URLSearchParams({\n        q: query,\n        per_page: PER_PAGE,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page,\n    });\n\n    const url = `${URL_PIXABAY}?key=${API_KEY}&${searchParams}`;\n\n    const response = await axios.get(url);\n\n    if (response.data.hits.length === 0) {\n        const msg = 'Не знайшлося відповідного контенту, спробуйте знову';\n        throw new Error(msg);\n    }\n\n    return response.data;\n}\n","import { linkEl } from '../main';\nconst listEl = document.querySelector('.gallery');\nexport function photoMarkup(data) {\n    const murkupEl = data.hits\n        .map(\n            ({\n                webformatURL,\n                largeImageURL,\n                tags,\n                likes,\n                views,\n                comments,\n                downloads,\n            }) => `\n            <li class=\"gallery-item\">\n                <a href=\"${largeImageURL}\" class=\"gallery-link\">\n                    <img src=\"${webformatURL}\" alt=\"${tags}\" class=\"gallery-image\" />\n                </a>\n                <div class=\"info\">\n                    <p class=\"info-item\"><span>Likes</span> ${likes}</p>\n                    <p class=\"info-item\"><span>Views</span> ${views}</p>\n                    <p class=\"info-item\"><span>Comments</span> ${comments}</p>\n                    <p class=\"info-item\"><span>Downloads</span> ${downloads}</p>\n                </div>\n            </li>\n        `\n        )\n        .join('');\n    linkEl.list.insertAdjacentHTML('beforeend', murkupEl);\n}\n","// Описаний у документації\nimport iziToast from 'izitoast';\n// Додатковий імпорт стилів\nimport 'izitoast/dist/css/iziToast.min.css';\n\n// Описаний у документації\nimport SimpleLightbox from 'simplelightbox';\n// Додатковий імпорт стилів\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport axios from 'axios';\n\nimport { fetchImages } from './js/pixabay-api.js';\nimport { photoMarkup } from './js/render-functions.js';\nimport { PER_PAGE } from './js/pixabay-api.js';\nexport const linkEl = {\n    form: document.querySelector('.form'),\n    loader: document.querySelector('.loader'),\n    list: document.querySelector('.gallery'),\n    loadMoreBtn: document.querySelector('.load-more-btn'),\n};\n\nlinkEl.form.addEventListener('submit', formHandler);\nlinkEl.loadMoreBtn.addEventListener('click', loadMoreBtnHandler);\n\n//\n//  для галереї\nlet gallery = new SimpleLightbox('.gallery a');\n//\n// пагінація\nlet pageCount = 1;\nlet query = null;\nlet pagesOfEverything = 0;\n//\n\n// обробник кнопки дозавантаження\nasync function loadMoreBtnHandler(e) {\n    pageCount += 1;\n\n    try {\n        const data = await fetchImages(query, pageCount);\n        pagesOfEverything = data.totalHits / PER_PAGE;\n        if (data.hits.length === 0 || pageCount > pagesOfEverything) {\n            linkEl.loadMoreBtn.classList.add('is-hidden');\n            setTimeout(() => {\n                iziToast.error({\n                    position: 'topRight',\n                    message:\n                        'Вибачте, але ви досягли кінця результатів пошуку.',\n                });\n            }, 1000);\n\n            // Виходимо з функції, якщо немає нових даних\n        }\n        photoMarkup(data);\n\n        gallery.refresh();\n        scroll();\n    } catch (error) {\n        console.log(error);\n    }\n}\n\n//\nasync function formHandler(e) {\n    e.preventDefault();\n    const form = e.currentTarget;\n    //  очищаємо вміст перед новим запитом\n    linkEl.loadMoreBtn.classList.add('is-hidden');\n    pageCount = 1;\n    linkEl.list.innerHTML = '';\n    // отримуємо значення запиту від користувача, оновлюємо змінну та перевіряємо його\n    query = e.target.elements['search-area'].value.trim();\n\n    if (query === '') {\n        iziToast.error({\n            position: 'topRight',\n            message: 'Введіть будь-ласка значення для пошуку',\n        });\n        return;\n    }\n\n    // перед запитом показуємо лоадер\n\n    linkEl.loader.classList.add('active');\n\n    // робимо запит\n    try {\n        const data = await fetchImages(query, pageCount);\n\n        // обробка кількості сторінок\n        pagesOfEverything = data.totalHits / PER_PAGE;\n        //\n\n        photoMarkup(data);\n\n        linkEl.loader.classList.remove('active');\n        gallery.refresh();\n        if (data.hits.length < 15 || data.hits.length === 0) {\n            linkEl.loadMoreBtn.classList.add('is-hidden');\n        } else {\n            linkEl.loadMoreBtn.classList.remove('is-hidden');\n        }\n    } catch (error) {\n        linkEl.loader.classList.remove('active');\n        linkEl.loadMoreBtn.classList.add('is-hidden');\n\n        linkEl.list.innerHTML = '';\n\n        iziToast.error({\n            position: 'topRight',\n            message: error.message,\n        });\n    } finally {\n        form.reset();\n    }\n}\n\nfunction scroll() {\n    const lastEl = linkEl.list.lastElementChild;\n\n    const heightEl = lastEl.getBoundingClientRect().height;\n\n    window.scrollBy({\n        top: heightEl * 2,\n        left: 0,\n        behavior: 'smooth',\n    });\n}\n"],"names":["URL_PIXABAY","API_KEY","PER_PAGE","fetchImages","query","page","searchParams","url","response","axios","msg","photoMarkup","data","murkupEl","webformatURL","largeImageURL","tags","likes","views","comments","downloads","linkEl","formHandler","loadMoreBtnHandler","gallery","SimpleLightbox","pageCount","pagesOfEverything","e","iziToast","scroll","error","form","heightEl"],"mappings":"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"}